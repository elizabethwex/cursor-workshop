---
import WorkshopLayout from "../layouts/WorkshopLayout.astro";
import SystemMessage from "../components/SystemMessage.astro";
import ModulePageWithTasks from "../components/ModulePageWithTasks.astro";
import CursorPrompts from "../components/CursorPrompts.astro";
import CollapsibleSection from "../components/CollapsibleSection.astro";
import ModuleGoalPanel from "../components/ModuleGoalPanel.astro";
import content from "../content/steps/04-explore-cursor.ts";
---

<WorkshopLayout title="Explore Cursor" description="Learn how Cursor helps you explore and modify code. Completion unlocks CONTRIBUTION.">
  <article class="module-page cursor-module">
    <header class="module-header">
      <h1>Cursor</h1>
      <dl class="module-meta" aria-label="Module info">
        <dt>Module</dt>
        <dd>CURSOR</dd>
        <dt>Access Requirement</dt>
        <dd>Operator</dd>
        <dt>Completion Unlocks</dt>
        <dd>(No access change)</dd>
      </dl>
    </header>

    <ModuleGoalPanel goal={content.goal} estimatedTime={content.estimatedTime} />

    <ModulePageWithTasks moduleId="explore-cursor" tasks={content.tasks} taskSectionIds={content.taskSectionIds}>
      <p class="step-intent" aria-label="Status">
        <em>Cursor interface active.</em>
      </p>

      <SystemMessage message={content.systemMessage} typed={true} />

      <section class="step-card" aria-labelledby="working-with-cursor">
      <h2 id="working-with-cursor">Working With Cursor</h2>
      <p>Cursor is the tool you’ll use to explore and modify code.</p>
      <p>It is not here to replace you.</p>
      <p>It is here to help you move through unfamiliar systems with confidence.</p>
      <p>You remain in control.</p>
      </section>

      <CollapsibleSection id="what-cursor-is-good-at" title="What Cursor Is Good At" stepCard={true}>
      <h2 id="what-cursor-is-good-at">What Cursor Is Good At</h2>
      <p>Cursor is especially useful for:</p>
      <ul>
        <li>Explaining unfamiliar files</li>
        <li>Finding where things are defined</li>
        <li>Suggesting small, safe changes</li>
        <li>Helping debug errors</li>
      </ul>
      <p>You don’t need to know the right words.</p>
      <p>You can ask questions in plain language.</p>
    </CollapsibleSection>

      <CollapsibleSection id="how-cursor-fits" title="How Cursor Fits Into Your Workflow" stepCard={true} taskIndex={1} moduleId="explore-cursor">
      <h2 id="how-cursor-fits">How Cursor Fits Into Your Workflow</h2>
      <p>Think of Cursor as:</p>
      <ul>
        <li>A guide when you’re lost</li>
        <li>A translator when code feels dense</li>
        <li>A second set of eyes when something breaks</li>
      </ul>
      <p>It does not make decisions for you.</p>
      <p>You decide what changes get made.</p>
    </CollapsibleSection>

      <CollapsibleSection id="core-actions" title="Core Cursor Actions" stepCard={true} taskIndex={0} moduleId="explore-cursor">
      <h2 id="core-actions">Core Cursor Actions</h2>
      <p>You’ll use these actions often. Try each one at least once.</p>

      <h3>Open and Read a File</h3>
      <ul>
        <li>Use the file tree to open any file in the project</li>
        <li>Skim it without trying to understand everything</li>
      </ul>
      <p>Understanding comes later.</p>

      <h3>Search the Project</h3>
      <ul>
        <li>Use search to find a word or phrase</li>
        <li>This is often faster than browsing folders</li>
      </ul>
      <p>Searching is a valid strategy.</p>

      <h3>Ask Cursor About Code</h3>
      <p>Select a block of code, then ask Cursor questions like:</p>
      <ul>
        <li>“What does this file do?”</li>
        <li>“How does this affect the UI?”</li>
        <li>“Is this safe to change?”</li>
      </ul>
      <p>Cursor will respond in plain language.</p>

      <h3>Ask for a Small Change</h3>
      <p>You can also ask Cursor to help you make a change.</p>
      <p>For example:</p>
      <ul>
        <li>“Change this text to be more descriptive”</li>
        <li>“Update this color value”</li>
        <li>“Rename this variable to something clearer”</li>
      </ul>
      <p>Small changes are encouraged.</p>
    </CollapsibleSection>

    <CollapsibleSection id="safe-experiment" title="A Safe First Experiment" stepCard={true}>
      <h2 id="safe-experiment">A Safe First Experiment</h2>
      <p>If you’re unsure where to start, try this:</p>
      <ol>
        <li>Find a visible piece of text in the UI</li>
        <li>Use search to locate it in the code</li>
        <li>Ask Cursor what file controls it</li>
        <li>Change the text slightly</li>
        <li>Save the file and refresh the browser</li>
      </ol>
      <p>If the UI updates, everything worked.</p>
      <p>If it doesn’t, nothing is broken.</p>
    </CollapsibleSection>

      <CollapsibleSection id="if-stuck" title="If You Feel Stuck" stepCard={true}>
      <h2 id="if-stuck">If You Feel Stuck</h2>
      <p>That’s expected.</p>
      <p>When this happens:</p>
      <ul>
        <li>Ask Cursor what you’re looking at</li>
        <li>Ask Cursor where to make a change</li>
        <li>Ask Cursor to explain an error message</li>
      </ul>
      <p>You do not need to solve this alone.</p>
    </CollapsibleSection>

      <CollapsibleSection id="not-expected" title="What You're Not Expected to Do" stepCard={true}>
      <h2 id="not-expected">What You’re Not Expected to Do</h2>
      <p>You are not required to:</p>
      <ul>
        <li>Understand the entire codebase</li>
        <li>Write complex logic</li>
        <li>Know framework details</li>
      </ul>
      <p>Your job is to navigate, not master.</p>
    </CollapsibleSection>

      <CollapsibleSection id="complete-module" title="Complete This Module" stepCard={true} taskIndex={3} moduleId="explore-cursor">
      <h2 id="complete-module">Complete This Module</h2>
      <p>Once you’ve:</p>
      <ul>
        <li>Opened files</li>
        <li>Used search</li>
        <li>Asked Cursor at least one question</li>
        <li>Made or considered a small change</li>
      </ul>
      <p>You’re ready to move on.</p>
      <p>The next module will guide you through making a real contribution.</p>
    </CollapsibleSection>

      <CursorPrompts prompts={content.cursorPrompts} />

    <section id="cursor-mark-complete" class="welcome-mark-complete module-mark-complete" aria-label="Mark module complete">
      <p id="cursor-mark-complete-confirm" class="system-message welcome-mark-complete-msg" role="status" aria-live="polite" hidden>
        Cursor exploration marked complete. Next module available: CONTRIBUTION.
      </p>
      <div id="cursor-mark-complete-actions">
        <button type="button" id="cursor-mark-complete-btn" class="workshop-btn workshop-btn--primary">
          Mark Cursor exploration complete
        </button>
      </div>
      </section>

      <p class="module-next-hint">
        <em>On completion:</em> Module complete. Access level unchanged. Next module available: CONTRIBUTION.
      </p>
    </ModulePageWithTasks>
  </article>
</WorkshopLayout>

<script>
  import { markModuleComplete, isModuleComplete } from "../lib/progress";

  const btn = document.getElementById("cursor-mark-complete-btn");
  const confirmEl = document.getElementById("cursor-mark-complete-confirm");

  function showConfirmation() {
    if (confirmEl) {
      confirmEl.hidden = false;
      confirmEl.setAttribute("aria-live", "polite");
    }
    if (btn) btn.hidden = true;
  }

  if (isModuleComplete("explore-cursor")) {
    showConfirmation();
  } else if (btn) {
    btn.addEventListener("click", () => {
      markModuleComplete("explore-cursor");
      document.dispatchEvent(new CustomEvent("workshop-progress-update"));
      const base = typeof import.meta.env !== "undefined" && import.meta.env.BASE_URL ? import.meta.env.BASE_URL : "/cursor-workshop/";
      window.location.replace(base);
    });
  }
</script>
